@{
    Layout = "~/Views/Shared/_ResponsiveLayout.cshtml";
    
}
<div class='container'>
    <!--header-->
    <div class='row clearfix'>
        <h2>
            Manage Sub Items For @ViewBag.mtsp.Description</h2>
    </div>

 
    @Html.ValidationSummary()

    <div class='row clearfix'>
        @{ Html.BeginForm("ProcessEditSingleMilestoneTreeProfileSubItems", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }); }
        @{
            if (ViewBag.ParentDropdownFieldList.Count > 0)
            {
               
            <p style='font-weight: bold'>
                Parent</p>
            
            <select name='parent' class='manage-profile-sub-items'>
                <option value=''>Choose A Parent</option>
                @foreach (Scheduling.Models.MilestoneField mf in ViewBag.ParentDropdownFieldList)
                {
                       
                    <option value='@mf.ID'>@mf.Description</option>
             
                }
            </select>
            }

            else
            {
                
            <p>
                There are no Milestones defined for this baseline</p>
                
      
            }  
            <div class='add-sub-item-to-profile'>
            <p>Name </p>
            <input type='text' value='' name='ItemName' class='add-sub-item-to-profile-milestone-field-text' />

            <div >
                    <p>
                        Calculation</p>
                    <select name='calculation' class='add-sub-item-to-profile-select-calc-field'>
                        <option value=''>Choose a Calculation</option>
                        @{
                
                    //Calc Fields Start
                    foreach (Scheduling.Models.Calculation c in ViewBag.CalcList)
                    {
                       
                            <option value='@c.ID'>@c.ShortDesc</option>

                    }
                 
                        }
                    </select>
                </div>


                <!--dependancy-->
                 <div >
                    <p>
                        Dependancy</p>
                    <select name='dependancy' class='add-sub-item-to-profile-select-dep-field'>
                        <option value=''>Choose a Dependancy(Parent shown in parenthesis)</option>
                        @{
                
                     List<Scheduling.Models.MilestoneField> OrderedList=(List<Scheduling.Models.MilestoneField>)ViewBag.DepList;
                     OrderedList=OrderedList.OrderBy(x=>x.Description.Trim()).ToList();
                    //If it has a parent show in parenthesis
                    foreach (Scheduling.Models.MilestoneField d in OrderedList)
                    {
                           
                            <option value='@d.ID'>@d.Description</option>
                            
                    }
                 
                        }
                    </select>
                </div>

                <!--stop-->

            <input type='hidden' value='@ViewBag.mtsp.ID' name='id' />
            <input type='submit' value='Add Sub Item' />  @{ Html.EndForm(); }
            </div>
        }
        @{ Html.EndForm(); }
    </div>
    <!--show functionality-->
    <div class='row clearfix edit-profile-sub-item-help'>
    <img src="@Url.Content("~/images/help_75.png")" style='width:50px' alt='baseline sub item help'/>
     <div class='edit-profile-sub-item-help-text'>
     
     <p style='font-size:0.8em;font-style:italic'>Sub Items are assigned to parent items and the current firing order  is generated by the system based on the current maximum calculation firing order value for this baseline.<br />
     If this is the first calculation then it will be given a firing order value of 5.

     </p>
     
     

     </div>
    </div>

    <div class='row clearfix'>
        @{
            if (ViewBag.ParentIds.Count > 0)
            {
                
                foreach(int i in ViewBag.ParentIds)
                {
                     @Html.Partial("_SubItemPartial",ViewData["parent"]=i);
                }


            }


            else
            {
                <p>There are no sub items</p>
                
                
            }
        
        }
    </div>
</div>
